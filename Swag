import pandas as pd

# Define the breakdown
breakdown = [80, 20]

def split_dataset(PRT360_LEAD_DIST_ACCESS_FINAL_OUTPUT):
    # Sort the dataset by "LATEST_IXI" in descending order
    sorted_dataset = PRT360_LEAD_DIST_ACCESS_FINAL_OUTPUT.sort_values(by="LATEST_IXI", ascending=False)
    
    # Calculate the split indices
    first_split_index = int(len(sorted_dataset) * (breakdown[0] / 100))
    
    # Split the dataset
    Leads_Daily_ToBeProcessed = sorted_dataset.iloc[:first_split_index]
    Leads_Daily_ToBeProcessed_Unranked = sorted_dataset.iloc[first_split_index:]
    
    return Leads_Daily_ToBeProcessed, Leads_Daily_ToBeProcessed_Unranked

# Example usage
if __name__ == "__main__":
    # Generate a mock dataset (replace this with your actual dataset)
    data = {'LATEST_IXI': [1.2, 2.4, 3.5, 4.1, 5.9, 6.3, 7.0, 8.8, 9.6, 10.1]}
    PRT360_LEAD_DIST_ACCESS_FINAL_OUTPUT = pd.DataFrame(data)

    # Split the dataset
    Leads_Daily_ToBeProcessed, Leads_Daily_ToBeProcessed_Unranked = split_dataset(PRT360_LEAD_DIST_ACCESS_FINAL_OUTPUT)

    print("Leads_Daily_ToBeProcessed DataFrame:")
    print(Leads_Daily_ToBeProcessed)
    print("\nLeads_Daily_ToBeProcessed_Unranked DataFrame:")
    print(Leads_Daily_ToBeProcessed_Unranked)
