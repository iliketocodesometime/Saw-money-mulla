'=== (n) Slide 7 "TableNPS" (New Plan Sales reference data) ===
On Error Resume Next
Dim shpNPS As PowerPoint.Shape
Set shpNPS = pres.Slides(7).Shapes("TableNPS")
On Error GoTo 0

If Not shpNPS Is Nothing Then
    Dim tbl As PowerPoint.Table
    Set tbl = shpNPS.Table

    ' Clear all rows except header
    Do While tbl.Rows.Count > 1
        tbl.Rows(tbl.Rows.Count).Delete
    Loop

    For iRow = 2 To lastRowSales
        If Not IsError(wsSales.Cells(iRow, colDirSales).Value) Then
            Dim dRef As String
            dRef = Trim(wsSales.Cells(iRow, colDirSales).Value)
            If dRef = director And IsDirectorValid(dRef) Then
                Dim accName As String, closeDate As String, stage As String
                Dim estAUM As String, estParts As String

                accName = CStr(wsSales.Cells(iRow, colAccSales).Value)
                closeDate = CStr(wsSales.Cells(iRow, FindColumnIndex(wsSales, "Close Date")).Value)
                stage = CStr(wsSales.Cells(iRow, FindColumnIndex(wsSales, "Stage")).Value)
                estAUM = CStr(wsSales.Cells(iRow, colAUMSales).Value)
                estParts = CStr(wsSales.Cells(iRow, colPartSales).Value)

                ' Add new row
                tbl.Rows.Add
                With tbl.Rows(tbl.Rows.Count)
                    .Cells(1).Shape.TextFrame.TextRange.Text = accName
                    .Cells(2).Shape.TextFrame.TextRange.Text = closeDate
                    .Cells(3).Shape.TextFrame.TextRange.Text = stage
                    .Cells(4).Shape.TextFrame.TextRange.Text = estAUM
                    .Cells(5).Shape.TextFrame.TextRange.Text = estParts
                End With
            End If
        End If
    Next iRow
End If
