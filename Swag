Sub GenerateDirectorPresentations()
    Dim ws As Worksheet
    Dim pptApp As Object
    Dim pptPres As Object
    Dim pptSlide As Object
    Dim tcChart As Object
    Dim lastRow As Long
    Dim directorDict As Object
    Dim director As Variant
    Dim directorCount As Object
    Dim slidePath As String
    Dim outputPath As String
    
    ' Set references to the Excel sheet and initialize variables
    Set ws = ThisWorkbook.Sheets("New Plan Pipeline")
    lastRow = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    Set directorDict = CreateObject("Scripting.Dictionary")
    Set directorCount = CreateObject("Scripting.Dictionary")
    
    ' Loop through the data to count sales per director
    Dim i As Long
    For i = 2 To lastRow
        director = ws.Cells(i, "B").Value ' Column "Director"
        If Not directorDict.exists(director) Then
            directorDict.Add director, director
            directorCount.Add director, 0
        End If
        ' Increment the count for each entry regardless of stage
        directorCount(director) = directorCount(director) + 1
    Next i
    
    ' Create PowerPoint instance
    Set pptApp = CreateObject("PowerPoint.Application")
    pptApp.Visible = True
    
    ' Set the template path (update this path accordingly)
    slidePath = "C:\Path\To\Template.pptx"
    outputPath = "C:\Path\To\Output\"

    ' Loop through each director to create presentations
    For Each director In directorDict.Keys
        Set pptPres = pptApp.Presentations.Open(slidePath)
        Set pptSlide = pptPres.Slides(2) ' Access Slide 2
        
        ' Find Think-Cell chart and update it
        For Each tcChart In pptSlide.Shapes
            If tcChart.Type = msoLinkedOLEObject Then
                If InStr(tcChart.OLEFormat.progID, "ThinkCell.Chart") > 0 Then
                    ' Prepare data for Think-Cell chart
                    Dim chartData As Variant
                    ReDim chartData(1 To 2, 1 To 1)
                    chartData(1, 1) = director
                    chartData(2, 1) = directorCount(director)
                    
                    ' Update Think-Cell chart
                    tcChart.OLEFormat.Object.SetData chartData
                End If
            End If
        Next tcChart
        
        ' Save the presentation with the director's name
        pptPres.SaveAs outputPath & director & "_Presentation.pptx"
        pptPres.Close
    Next director
    
    ' Cleanup
    pptApp.Quit
    Set pptApp = Nothing
    Set directorDict = Nothing
    Set directorCount = Nothing
    
    MsgBox "Presentations created successfully!", vbInformation
End Sub
