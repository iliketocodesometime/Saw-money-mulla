import dataiku
import pandas as pd

# Define the folder to access
folder = dataiku.Folder("your_folder_id")

# List files in the folder
file_list = folder.list_paths_in_partition()

# Filter files with the consistent prefix
prefix = "your_consistent_prefix"
matching_files = [f for f in file_list if f.startswith(prefix) and f.endswith('.xlsx')]

# Sort by the most recent file (if multiple)
latest_file = sorted(matching_files)[-1]

# Read the Excel file into a pandas DataFrame
with folder.get_download_stream(latest_file) as stream:
    df = pd.read_excel(stream)

# Display the dataframe (optional)
df.head()
