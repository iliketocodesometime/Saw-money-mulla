# Initialize the result dataframe
result_df = pd.DataFrame(columns=["Opportunity Category", "Opportunity Type", "Account Name", "Closed Date", "Director", "Director Role", "Stage"])

# Cross Sell Closed Won
merged_df = dfCross_Sell_Closed_Won.merge(df_client_list, left_on="BBB Number", right_on="BBB Number Master", how="inner")
merged_df["Opportunity Category"] = "Cross Sell"
merged_df["Opportunity Type"] = merged_df["Business"]
merged_df["Account Name"] = merged_df["Account Name_x"]
merged_df["Closed Date"] = merged_df["Close Date"]
merged_df["Stage"] = "Closed"

result_df = pd.concat([result_df, merged_df[["Opportunity Category", "Opportunity Type", "Account Name", "Closed Date", "Director", "Director Role", "Stage"]]])

# Cross Sell Pipeline
merged_df = dfCross_Sell_Pipeline.merge(df_client_list, left_on="BBB Number", right_on="BBB Number Master", how="inner")
merged_df["Opportunity Category"] = "Cross Sell"
merged_df["Opportunity Type"] = merged_df["Business"]
merged_df["Account Name"] = merged_df["Account Name_x"]
merged_df["Closed Date"] = merged_df["Close Date"]
merged_df["Stage"] = merged_df["Stage_x"]

result_df = pd.concat([result_df, merged_df[["Opportunity Category", "Opportunity Type", "Account Name", "Closed Date", "Director", "Director Role", "Stage"]]])

# GAS Upsell Pipeline
merged_df = dfGAS_Pipeline.merge(df_client_list, left_on="BBB Number", right_on="BBB Number Master", how="inner")
merged_df["Opportunity Category"] = "Upsell"
merged_df["Opportunity Type"] = merged_df["Business"]
merged_df["Account Name"] = merged_df["Account Name_x"]
merged_df["Closed Date"] = merged_df["Close Date"]
merged_df["Stage"] = merged_df["Opportunity: Stage"]

result_df = pd.concat([result_df, merged_df[["Opportunity Category", "Opportunity Type", "Account Name", "Closed Date", "Director", "Director Role", "Stage"]]])

# GAS Closed Won
merged_df = dfGAS_Closed_Won.merge(df_client_list, left_on="BBB Number", right_on="BBB Number Master", how="inner")
merged_df["Opportunity Category"] = "Upsell"
merged_df["Opportunity Type"] = merged_df["Business"]
merged_df["Account Name"] = merged_df["Account Name_x"]
merged_df["Closed Date"] = merged_df["Close Date"]
merged_df["Stage"] = merged_df["Opportunity: Stage"]

result_df = pd.concat([result_df, merged_df[["Opportunity Category", "Opportunity Type", "Account Name", "Closed Date", "Director", "Director Role", "Stage"]]])

# Education Deepening
merged_df = dfEducation.merge(df_client_list, left_on="BBB Number", right_on="BBB Number Master", how="inner")
merged_df["Opportunity Category"] = "Deepening"
merged_df["Opportunity Type"] = "Education"
merged_df["Account Name"] = merged_df["Account Name_x"]
merged_df["Closed Date"] = merged_df["Date"]
merged_df["Stage"] = "Closed Won"

result_df = pd.concat([result_df, merged_df[["Opportunity Category", "Opportunity Type", "Account Name", "Closed Date", "Director", "Director Role", "Stage"]]])

# EAA Deepening
merged_df = dfEAA.merge(df_client_list, left_on="BBB Number", right_on="BBB Number Master", how="inner")
merged_df["Opportunity Category"] = "Deepening"
merged_df["Opportunity Type"] = "EAA"
merged_df["Account Name"] = merged_df["Account Name_x"]
merged_df["Closed Date"] = merged_df["EAA Onboarding Date"]
merged_df["Stage"] = merged_df["EAA Status"]

result_df = pd.concat([result_df, merged_df[["Opportunity Category", "Opportunity Type", "Account Name", "Closed Date", "Director", "Director Role", "Stage"]]])

# Reset index for result_df
result_df.reset_index(drop=True, inplace=True)

# Final result_df is ready
print(result_df.head())
