'=== (q) Slide 10 "TableCSP" (Cross Sell Pipeline reference with stage filter) ===
On Error Resume Next
Set shpNPS = pres.Slides(10).Shapes("TableCSP")
On Error GoTo 0
If Not shpNPS Is Nothing Then
    Set tbl = shpNPS.Table
    Do While tbl.Rows.Count > 1: tbl.Rows(tbl.Rows.Count).Delete: Loop

    Dim validPipelineStages As Variant
    validPipelineStages = Array("Active Pursuit", "Shortlisted / Decision Pending", "Verbal Agreement", "Contract Negotiation")

    For iRow = 2 To lastRowCrossPipe2
        If Trim(wsCrossSellPipe.Cells(iRow, colDirCSPipe).Value) = director Then
            Dim stageVal As String
            stageVal = Trim(wsCrossSellPipe.Cells(iRow, colStageCSPipe).Value)
            Dim isValidStage As Boolean: isValidStage = False

            Dim s As Long
            For s = LBound(validPipelineStages) To UBound(validPipelineStages)
                If stageVal = validPipelineStages(s) Then
                    isValidStage = True
                    Exit For
                End If
            Next s

            If isValidStage Then
                tbl.Rows.Add
                With tbl.Rows(tbl.Rows.Count)
                    .Cells(1).Shape.TextFrame.TextRange.Text = CStr(wsCrossSellPipe.Cells(iRow, FindColumnIndex(wsCrossSellPipe, "Account Name")).Value)
                    .Cells(2).Shape.TextFrame.TextRange.Text = CStr(wsCrossSellPipe.Cells(iRow, colOppTypeCSPipe).Value)
                    .Cells(3).Shape.TextFrame.TextRange.Text = stageVal
                End With
            End If
        End If
    Next iRow
End If
