'=== (m-1) Slide 5: TableReinvest from SPD Revenue ===
Dim wsSPD As Worksheet
On Error Resume Next
Set wsSPD = ThisWorkbook.Sheets("SPD Revenue")
On Error GoTo 0

If Not wsSPD Is Nothing Then
    Dim colDirSPD As Long, colAcctSPD As Long
    Dim colDateSPD As Long, colAttrSPD As Long, colYTDSPD As Long

    colDirSPD = FindColumnIndex(wsSPD, "Director")
    colAcctSPD = FindColumnIndex(wsSPD, "KEY_ACCT_PRIMARY")
    colDateSPD = FindColumnIndex(wsSPD, "ALG_FUND_DATE")
    colAttrSPD = FindColumnIndex(wsSPD, "ATTRB")
    colYTDSPD = FindColumnIndex(wsSPD, "YTD_NNA")

    If colDirSPD > 0 And colAcctSPD > 0 And colDateSPD > 0 And colAttrSPD > 0 And colYTDSPD > 0 Then
        Dim countLeads As Long: countLeads = 0
        Dim sumNNA As Double: sumNNA = 0
        Dim rowSPD As Long
        Dim thisYearStart As Date
        thisYearStart = DateSerial(Year(Date), 1, 1)

        Dim lastRowSPD As Long
        lastRowSPD = wsSPD.Cells(wsSPD.Rows.Count, colAcctSPD).End(xlUp).Row

        For rowSPD = 2 To lastRowSPD
            If Trim(wsSPD.Cells(rowSPD, colDirSPD).Value) = director Then
                If UCase(Trim(wsSPD.Cells(rowSPD, colAttrSPD).Value)) = "DISTRIBUTED" Then
                    Dim dateStr As String
                    dateStr = Trim(wsSPD.Cells(rowSPD, colDateSPD).Value)
                    If dateStr <> "" Then
                        Dim fundDate As Date
                        On Error Resume Next
                        fundDate = CDate(Left(dateStr, 10))
                        On Error GoTo 0

                        If fundDate >= thisYearStart Then
                            countLeads = countLeads + 1
                            If IsNumeric(wsSPD.Cells(rowSPD, colYTDSPD).Value) Then
                                sumNNA = sumNNA + wsSPD.Cells(rowSPD, colYTDSPD).Value
                            End If
                        End If
                    End If
                End If
            End If
        Next rowSPD

        Dim shpReinvest As PowerPoint.Shape
        On Error Resume Next
        Set shpReinvest = pres.Slides(5).Shapes("TableReinvest")
        On Error GoTo 0

        If Not shpReinvest Is Nothing Then
            With shpReinvest.Table
                .Cell(2, 2).Shape.TextFrame.TextRange.Text = CStr(countLeads)
                .Cell(3, 2).Shape.TextFrame.TextRange.Text = Format(sumNNA, "$#,##0")
            End With
        End If
    End If
End If
